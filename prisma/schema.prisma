generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id                 String    @id @default(cuid())
  email              String    @unique
  password           String
  name               String?
  roles              String    @default("[\"EDITOR\"]")
  mustChangePassword Boolean   @default(false)
  resetToken         String?
  resetTokenExpiry   DateTime?
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt
}

model Project {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  description String?
  content     String
  images      String   @default("[]")
  documents   String   @default("[]")
  isHighlight Boolean  @default(false)
  status      String   @default("CURRENT")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model News {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  content     String
  images      String   @default("[]")
  documents   String   @default("[]")
  isHighlight Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Application {
  id             String    @id @default(cuid())
  firstName      String
  lastName       String
  email          String
  phone          String
  instagram      String?
  description    String
  type           String    @default("MEMBER")
  status         String    @default("NEW")
  birthDate      DateTime?
  assignedUserId String?
  deletionReason String?
  createdAt      DateTime  @default(now())
  number         Int       @default(0)
}

model VisitLog {
  id        String   @id @default(cuid())
  path      String
  createdAt DateTime @default(now())
}

model ContactMessage {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String?
  message   String
  status    String   @default("NEW")
  createdAt DateTime @default(now())
  number    Int      @default(0)
}

model SiteConfig {
  id                   String   @id @default("main")
  orgName              String?
  orgAddress           String?
  orgNip               String?
  orgRegon             String?
  orgBankAccount       String?
  siteName             String?
  logoUrl              String?
  email                String?
  phone                String?
  facebookUrl          String?
  instagramUrl         String?
  tiktokUrl            String?
  discordUrl           String?
  updatedAt            DateTime @updatedAt
  showBoard            Boolean  @default(true)
  showOffice           Boolean  @default(true)
  showCoordinators     Boolean  @default(true)
  showCollaborators    Boolean  @default(true)
  showHero             Boolean  @default(true)
  showNews             Boolean  @default(true)
  showProjects         Boolean  @default(true)
  showPartners         Boolean  @default(true)
  enableHeroSlider     Boolean  @default(true)
  staticHeroTitle      String?
  staticHeroSubtitle   String?
  staticHeroImage      String?
  staticHeroAlignment  String   @default("center")
  staticHeroAuthor     String?
  aboutUsText          String?
  aboutUsGoals         String?
  aboutUsJoinText      String?
  // Email Configuration
  emailProvider        String   @default("smtp") // "smtp" or "resend"
  resendApiKey         String?
  emailFromContact     String?  @default("kontakt@risegen.pl")
  emailFromApplications String? @default("rekrutacja@risegen.pl")
  emailFromSupport     String?  @default("pomoc@risegen.pl")
  emailFromNewsletter  String?  @default("newsletter@risegen.pl")

  // Legacy SMTP (Deprecated)
  smtpHost             String?
  smtpPort             Int?
  smtpUser             String?
  smtpPassword         String?
  smtpFrom             String?  // Global fallback
  emailForApplications String?  // Where to SEND notifications TO
  emailForContact      String?  // Where to SEND contact msgs TO

  // Integrations - Discord
  discordWebhookContactUrl       String? // Wiadomości z formularza kontaktowego
  discordWebhookApplicationUrl   String? // Zgłoszenia (Rekrutacja)

  // Integrations - Przelewy24 (Donations)
  enableDonations      Boolean  @default(false)
  p24MerchantId        String?
  p24PosId             String?
  p24ApiKey            String?
  p24Crc               String?
  p24IsSandbox         Boolean  @default(false)
  showBankTransferDetails Boolean @default(true)

  // 1.5% Tax Settings
  showTaxOnePointFive  Boolean  @default(false)
  taxKrs               String?
  taxGoal              String?

  // SEO & Scripts
  seoTitle             String?
  seoDescription       String?
  seoKeywords          String?
  seoAuthor            String?
  seoRobots            String?
  faviconUrl           String?
  ogImageUrl           String?
  aboutUsSublinks      String?
  headCode             String?
  footerCode           String?

  // Policies
  accessibilityInfo    String?
  accessibilityDeclarationContent String?
  privacyPolicyContent String?
  cookiePolicyContent  String?

  recaptchaSiteKey     String?
  recaptchaSecretKey   String?
  recaptchaVersion     String?  @default("v2")
  recaptchaProjectId   String?
  googleAnalyticsId    String?
  googleCalendarId     String?
  showEvents           Boolean  @default(true)
  showStats            Boolean  @default(true)
  isMaintenanceMode    Boolean  @default(false)
  maintenanceMessage   String?
  enableNewsletter     Boolean  @default(false)
  newsletterWelcomeSubject String?
  newsletterWelcomeContent String?

  // Drip Campaign Settings
  enableDripCampaign  Boolean  @default(true)
  dripDay2Delay       Int      @default(2)
  dripDay2Subject     String?
  dripDay2Content     String?
  dripDay5Delay       Int      @default(5)
  dripDay5Subject     String?
  dripDay5Content     String?
  lastDripRun         DateTime?

  // Home Page Settings
  showUpcomingEvents Boolean  @default(true)
  showActionCenter   Boolean  @default(true)
  homepageOrder      String   @default("hero,stats,action,news,events,projects,partners")
  supportPageOrder   String   @default("hero,bank_transfer,online_payment,info_tiles,tax_15,contact_cta")
  contactMapUrl      String?
  contactMapPin      String?
}

model Event {
  id        String   @id @default(cuid())
  title     String
  slug      String   @unique
  content   String
  date      DateTime
  location  String?
  images    String   @default("[]")
  documents String   @default("[]")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Subscriber {
  id        String   @id @default(cuid())
  email     String   @unique
  isActive  Boolean  @default(true)
  name      String?
  dripStep  Int      @default(0) // 0=Sent Welcome, 1=Sent Day2, 2=Sent Day5
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}


model FAQ {
  id        String   @id @default(cuid())
  question  String
  answer    String
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Stat {
  id        String   @id @default(cuid())
  label     String
  value     String
  icon      String?
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model AuditLog {
  id         String   @id @default(cuid())
  entityType String
  entityId   String
  action     String
  userId     String
  userEmail  String
  details    String
  createdAt  DateTime @default(now())
}

model Partner {
  id        String   @id @default(cuid())
  name      String
  type      String
  website   String?
  logo      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model TeamMember {
  id         String   @id @default(cuid())
  name       String
  role       String
  image      String?
  bio        String?
  categories String   @default("[]")
  email      String?
  phone      String?
  alignment  String   @default("center")
  order      Int      @default(0)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

model Document {
  id          String   @id @default(cuid())
  title       String
  description String?
  fileUrl     String
  category    String   @default("OTHER")
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model HomeHeroSlide {
  id        String   @id @default(cuid())
  image     String
  link      String?
  title     String?
  subtitle  String?
  author    String?
  alignment String   @default("center")
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Donation {
  id           String   @id @default(cuid())
  amount       Int      // In grosze
  currency     String   @default("PLN")
  description  String
  email        String
  status       String   @default("PENDING") // PENDING, COMPLETED, FAILED
  sessionId    String   @unique // P24 Session ID
  orderId      Int?     // P24 Order ID
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}
